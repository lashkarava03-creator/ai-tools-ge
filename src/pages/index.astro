---
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import AICard from '../components/AICard.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../consts';
import tools from '../data/tools.json';

// უნიკალური კატეგორიები
const categories = [...new Set(tools.map(tool => tool.category))];

// ძებნის ტექსტი URL-დან (?q=...)
const searchQuery = Astro.url.searchParams.get('q') || '';

// გაფილტრული ინსტრუმენტები
const filteredTools = tools.filter(tool =>
  tool.name.toLowerCase().includes(searchQuery.toLowerCase()) ||
  tool.description.toLowerCase().includes(searchQuery.toLowerCase())
);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<Header />
		<main>
<section>
  <form method="get" style="display:flex; gap:10px; justify-content:center;">
    <input 
      type="text"
      name="q"
      placeholder="მოძებნე AI ინსტრუმენტი..."
      value={searchQuery}
      style="padding:10px; width:100%; max-width:400px; border-radius:8px; border:1px solid #ddd;"
    />
    <button type="submit" style="padding:10px 16px; border-radius:8px; border:1px solid #ddd; cursor:pointer;">
      მოძებნა
    </button>
  </form>
</section>



  <h1> იპოვე საჭირო AI ინსტრუმენტები </h1>
  <p>ყველა პოპულარული AI ხელსაწყო ერთ ადგილზე — მარტივად და სწრაფად.</p>

  <section>
  <h2>კატეგორიები</h2>

  <div style="display:flex; gap:10px; flex-wrap:wrap;">
    {categories.map(category => (
      <a href={`#${category}`} style="padding:6px 12px; border:1px solid #ddd; border-radius:20px; text-decoration:none;">
        {category}
      </a>
    ))}
  </div>
</section>


 <section>
  <h2>AI ინსტრუმენტები</h2>

  {searchQuery ? (
  <div style="margin-top:24px;">
    <p>
      ნაპოვნია: <strong>{filteredTools.length}</strong>
    </p>

    {filteredTools.length === 0 && (
      <p style="margin-top:20px; color:#666;">
        ვერ მოიძებნა შესაბამისი AI ინსტრუმენტი
      </p>
    )}

    <div style="display:grid; gap:16px; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));">
      {filteredTools.map(tool => (
        <AICard
          name={tool.name}
          description={tool.description}
          category={tool.category}
          link={tool.link}
        />
      ))}
    </div>
  </div>
) : (
  <>
    {categories.map(category => (
      <div id={category} style="margin-top:40px;">
        <h3>{category}</h3>

        <div style="display:grid; gap:16px; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));">
          {tools
            .filter(tool => tool.category === category)
            .map(tool => (
              <AICard
                name={tool.name}
                description={tool.description}
                category={tool.category}
                link={tool.link}
              />
            ))}
        </div>
      </div>
    ))}
  </>
)}

</section>





</main>

		<Footer />
	</body>
</html>
